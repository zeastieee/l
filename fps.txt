local Statistics = Instance.new("ScreenGui")
local Holder = Instance.new("Frame")
local FPS = Instance.new("TextLabel")
local Ping = Instance.new("TextLabel")
local Problematic_Ping = Instance.new("ImageLabel")
local Problematic_FPS = Instance.new("ImageLabel")
 
Statistics.Name = "Statistics"
Statistics.Parent = game.CoreGui
Statistics.DisplayOrder = 100
Statistics.ResetOnSpawn = false

Holder.Name = "Holder"
Holder.Parent = Statistics
Holder.BackgroundColor3 = Color3.new(0, 0, 0)
Holder.BackgroundTransparency = 0.80000001192093
Holder.Position = UDim2.new(0.0111157084, 0, 0.186734378, 0)
Holder.Size = UDim2.new(0, 85, 0, 31)
Holder.ZIndex = -1

FPS.Name = "FPS"
FPS.Parent = Holder
FPS.AnchorPoint = Vector2.new(0.5, 0.5)
FPS.BackgroundColor3 = Color3.new(1, 1, 1)
FPS.BackgroundTransparency = 1
FPS.Position = UDim2.new(0.392650008, 0, 0.602429807, 0)
FPS.Size = UDim2.new(0.655250013, 0, 0.313371748, 0)
FPS.Font = Enum.Font.Code
FPS.Text = "FPS  : 60"
FPS.TextColor3 = Color3.new(1, 0.0235294, 0.984314)
FPS.TextSize = 14
FPS.TextStrokeTransparency = 0.5
FPS.TextXAlignment = Enum.TextXAlignment.Left

Ping.Name = "Ping"
Ping.Parent = Holder
Ping.AnchorPoint = Vector2.new(0.5, 0.5)
Ping.BackgroundColor3 = Color3.new(1, 1, 1)
Ping.BackgroundTransparency = 1
Ping.Position = UDim2.new(0.391378671, 0, 0.28993088, 0)
Ping.Size = UDim2.new(0.657793105, 0, 0.316794097, 0)
Ping.Font = Enum.Font.Code
Ping.Text = "Ping : 100"
Ping.TextColor3 = Color3.new(1, 0.0235294, 0.984314)
Ping.TextSize = 14
Ping.TextStrokeTransparency = 0.5
Ping.TextXAlignment = Enum.TextXAlignment.Left

Problematic_Ping.Name = "Problematic_Ping"
Problematic_Ping.Parent = Holder
Problematic_Ping.BackgroundColor3 = Color3.new(1, 1, 1)
Problematic_Ping.BackgroundTransparency = 1
Problematic_Ping.Position = UDim2.new(0.805765748, 0, 0.101375103, 0)
Problematic_Ping.Size = UDim2.new(0, 20, 0, 20)
Problematic_Ping.Visible = false
Problematic_Ping.Image = "rbxassetid://6238540373"
Problematic_Ping.ImageColor3 = Color3.new(1, 0, 0)

Problematic_FPS.Name = "Problematic_FPS"
Problematic_FPS.Parent = Holder
Problematic_FPS.BackgroundColor3 = Color3.new(1, 1, 1)
Problematic_FPS.BackgroundTransparency = 1
Problematic_FPS.Position = UDim2.new(0.805765748, 0, 0.53997159, 0)
Problematic_FPS.Size = UDim2.new(0, 20, 0, 20)
Problematic_FPS.Visible = false
Problematic_FPS.Image = "rbxassetid://6238540373"
Problematic_FPS.ImageColor3 = Color3.new(1, 0, 0)

local RunService = game:GetService("RunService")
local PingRemote = script.GetPing

local FPSCounter = script.Parent.Holder.FPS
local PingCounter = script.Parent.Holder.Ping

local Colors = {
	Good = Color3.fromRGB(0, 255, 0),
	Normal = Color3.fromRGB(255, 255, 0),
	Bad = Color3.fromRGB(255, 0, 0)
}

function GetPing()
	local Send = tick()
	local Ping = nil

	PingRemote:FireServer()

	local Receive; Receive = PingRemote.OnClientEvent:Connect(function()
		Ping = tick() - Send 
	end)

	wait(1)
	
	Receive:Disconnect()

	return Ping or 999
end

RunService.RenderStepped:Connect(function(TimeBetween)
	local FPS = math.floor(1 / TimeBetween)
	
	FPSCounter.Text = "FPS  : "..tostring(FPS)
	
	if FPS >= 50 then
		FPSCounter.TextColor3 = Colors.Good
		script.Parent.Holder.Problematic_FPS.Visible = false
	elseif FPS >= 30 then
		FPSCounter.TextColor3 = Colors.Normal
		script.Parent.Holder.Problematic_FPS.Visible = false
	elseif FPS >= 1 then
		FPSCounter.TextColor3 = Colors.Bad
		script.Parent.Holder.Problematic_FPS.Visible = true
	end
end)

local PingThread = coroutine.wrap(function()
	while wait() do
		local Ping = tonumber(string.format("%.3f", GetPing() * 1000))
		PingCounter.Text = "Ping : "..tostring(math.floor(Ping)).." ms"
		
		if Ping <= 100 then
			PingCounter.TextColor3 = Colors.Good
			script.Parent.Holder.Problematic_Ping.Visible = false
		elseif Ping <= 300 then
			PingCounter.TextColor3 = Colors.Normal
			script.Parent.Holder.Problematic_Ping.Visible = false
		elseif Ping > 300 then
			PingCounter.TextColor3 = Colors.Bad
			script.Parent.Holder.Problematic_Ping.Visible = true
		end
	end
end)

PingThread()

local PingRemote = script.Parent.Handler.GetPing

PingRemote.OnServerEvent:Connect(function(Player)
	PingRemote:FireClient(Player)
end)
